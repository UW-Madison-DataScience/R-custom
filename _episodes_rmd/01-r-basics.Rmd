---
title: "R basics"
author: "Tobin Magle"
teaching: 
exercises: 
questions:
- 
objectives:
- 
keypoints:
- 
source: Rmd
---

```{r setup, echo = FALSE, purl = FALSE, message = FALSE}
library(knitr)
library(tidyverse)
source("../bin/chunk-options.R")
```
Based on (http://www.datacarpentry.org/R-ecology-lesson/)

# Intro to R and RStudio

Many researchers use programming languages to automate the processing, analysis and visualization of their research data. **R** is a popular programming language that was initially designed as an open source statistical language. **RStudio** is a popular integrated development environment that makes working with R code easier. 

## Installation
R and RStudio must be installed separately for this lesson. The Data Carpentry Ecology lesson has excellent [setup instructions](https://datacarpentry.org/R-ecology-lesson/#setup_instructions)

## Why learn R?

Now that we have the software installed, let’s discuss why we might want to learn to code in R:

* First, R is free, open source and cross platform, allowing you to take it to any organization you may work at in the future. 
* R is also widely used for research computing. In fact, the R has over 10,000 extensions called packages, many of which were created by researchers.
* These packages allow R to import a variety of data types, from tabular and geospatial data, to text and genomic sequences.
* R also produces high quality, publication ready graphs. The code can be reused to make other graphs for similar data.
* Finally, coding in any language will make the analysis that you do more reproducible. With R, you can share executable scripts with colleagues, providing an exact accounting of what you did.

## Setting up your working directory

Good file organization practices are key to writing good code. 

> ## Hands on: Set up your project directory
> Follow these steps to set up your project directory
>
> * Open RStudio 
> * File >  New project > New directory > Empty project
> * Enter a name for this new folder: r-basics
> * Choose a convenient location: ~/Desktop
> * Click “Create project” 
>
> > ## Outcome
> > Your RStudio window should look like this:
> > <insert the image with annotation>
> > 
> {: .solution}
{: .challenge}

> ## Hands on: Create an R Script
> Follow these steps to set up your project directory
>
> * File > New File > R script
> * Save it in your project directory
> 
> > ## Outcome
> > Your RStudio window should look like this:
> > <insert the image with annotation>
> > 
> {: .solution}
{: .challenge}

The RStudio interface is made up of 4 windows: 

* The **script** window (upper right) is where you edit the text document that holds your code. The name of the file on the tab turns red when the file is not saved.
* The **console** (lower left) is where the code gets executed and output, such as warnings and error messages, are displayed.
* The **environment** tab (upper right) is shows the objects (ex: data) stored in the computer’s memory. You can also see what has been run in the console using the history tab.
* The **files** tab (lower right) shows your *working directory* and the files are contained in that directory.

## Scripts vs. the console

You have probably noticed that we have two places that accept code as input: the script and console windows

* Both of these windows will accept R commands
* The Console runs the commands, but doesn’t save them permanently, though they appear in the history tab on the upper right
* The script is where you save commands to run later. Once you type code in the script, you still need to send them to the console to be run.
* You can send the code to the console by copying and pasting, or putting your cursor on the line that you want to run, and pressing control enter on PC and command enter on the mac, or by hitting the run button at the top of the script window

# Operators and functions

Now that we're familiar with the RStudio interface, let's get coding! R scripts are written as a combination of **operators** and **functions**. Operators are symbols that perform operations on the values to the left and right of the symbol. Functions are similar, but are represented by a name that takes varying numbers of inputs. Both produce output. Let's take a look at operators first. 

## Types of operators

There are four basic operator types that are common in R and other programming languages. This table lists the categories, what they do, and what symbols are included in the category. 

Type|What it does|Symbol(s)
---|---|---
Arithmetic|Math on numbers|+ - * / ^
Assignment|Creates or changes contents of objects |<-
Extraction|Take out or replace part of an object|[ ] $ 
Logical|Compares values, returns TRUE/FALSE|>   <   ==   !   %in%  &   |

### Arithmetic operators

Arithmetic operators allow R to do math like add, subtract, multiply, and divide on numbers or variables. 

* These operators are useful with data because they allow us to compute unit conversion
* By default, the result of the mathematical computations goes to the console.

```{r arithmetic-operators}
#Add: 
2+2
#Subtract: 
3-1
#Multiply: 
4*4
#Divide: 
5/2
```

But what if we want to save the results to use later? 

### The assignment operator

The assignment operator (`<-`)saves values into objects (named containers that store values) to the R environment (the upper right pane). 

For example, we can assign the value 55 to the variable weight_kg.

```{r assignment-operator}
 weight_kg <- 55
```

The values in these variables can be overwritten by a second assignment operation, 
```{r overwrite-assignment}
weight_kg <- 66
```

The assignment operator can also can be combined with arithmetic operators.
```{r assignment-arithmetic}

weight_lb <- 2.2*weight_kg

```

> ## Challenge: Operators
> What are the values of each variable after each statement?
> 
> ```r
> mass <- 47.5                          # mass?
> age  <- 122                           # age?
> mass <- mass * 2.0                    # mass?
> age  <- age - 20                      # age?
> mass_index <- mass/age                # mass_index?
> ```
>
> > ## Solution
> > 
> > ```r
> > mass <- 47.5                      # mass is 47.5
> > age  <- 122                       # age is 122
> > mass <- mass * 2.0                # mass is 95
> > age  <- age - 20                  # age age is 102
> > mass_index <- mass/age            # mass_index is 0.9313725
> > ```
> >
> {: .solution}
{: .challenge}

## Functions

For more complicated tasks, R also comes pre-installed with a variety of **functions**. 
* Functions are a sequence of steps that perform a specific task.
* Each function has a name
* They accept input in the form of arguments,
and returns a value that can be assigned to a variable as output.

Let's look at some example functions: `sqrt()` and `round()`.

The square root function `sqrt()` takes a number as input (called an **argument**) and returns the square root of that number as output. 

```{r square-root}
sqrt(9)
```

Functions usually take at least one argument as input, but can take multiple. Let's look at the `round()` function as an example. 

The `round()` function takes at minimum a number as input and returns a rounded number as output.

```{r round-1}
round(3.14159)
```

By default, the number is rounded to the nearest whole number. We can change this behavior by using additional arguments. But how do we know what they are? The quickest way to get to the documentation about a function that you know the exact name is to use the `?` operator, which opens the function's help file in the **Help** tab in the lower right pane.

```{r round-help}
?round
```

This help file has information for a group of functions that are related to `round()` (`ceiling()`, `floor()`, etc.). In the usage section, we can see an example of how to use the round function:

> round(x, digits = 0)

This line tells the user that round can take up to 2 arguments: `x` and `digits`. The **Arguments** section defines what these arguments are. 

Argument name| Definition
----|-----
x	|a numeric vector. Or, for round and signif, a complex vector
digits	|integer indicating the number of decimal places (round)

We've been using the `x` argument implicitly: this is the number to be rounded. The `digits` argument has its default value set to 0, meaning that it will round to 0 decimal places. If we change this argument to 2, it will round to 2 decimal places. 

```{r round-named-arguments}
round(x = 3.14159, digits = 2)
```

You don't always need to name the arguments explicitly.

```{r round-unnamed-arguments}
round(3.14159, 2)
```

However, this can get confusing with functions that have many arguments. For example, if you put the arguments in the wrong order, you can get some unexpected results.  

```{r backward-arguments}
round(2, 3.14159)
```

In the previous example, `round()` is trying to round the number 2 to 3.14159 decimal places. You can put them in this order if you use their names though. 

```{r named-backward-arguments}
round(digits=2, x = 3.14159)
```

# Data Types
Now that we know how to use operators and functions to perform operations on values and objects using R, let's talk a bit about the data itself. When you save a value into an object using the assignment operator, R evaluates the value and assigns a **data type** to the object. 

* Data type is important, because it determines what operators and functions you can use with the object
* The basic data types in R are `numeric`, `character` and `logical`. We'll show examples of these types in this lesson
* This type represents R's best guess at what type the data represents. It's usually pretty easy to tell what data type an object is if it has a single element.
* You can use the `class()` function to check what type R thinks the data is

R interprets numbers (both integers and decimal numbers) as `numeric` data. 

```{r data-type-numeric}
x <- 32
class(x)
```

Numeric data works with the arithmetic operators and the `tound()` and `sqrt()` functions that we've already discussed. 

```{r data-type-numeric-op-fun}
x+x
sqrt(x)
```

R interprets anything enclosed in quote marks (`''` or `""`) as the `character` data type. I

```{r data-type-character}
y <- "hi"
class(y)
```

If you try to use a character object with arithmetic operators or functions that take numeric input, you will get an error message. 

```{r data-type-character-op-fun, error = TRUE}
y+y
sqrt(y)
```

Character objects are used with other functions like `paste()`, which joins strings together, separated by a space by default.

```{r data-type-character-paste}
paste(y,y)
```

Use the `sep` argument to change the separator
```{r data-type-character-paste-sep}
paste(y,y, sep = '.')
```

R interprets the special values `TRUE` and `FALSE` (not in quotes) as logical data. 

```{r data-type-logical}
z <- TRUE
class(z)
```

The usage of logical data is a bit complicated and makes more sense with more complex data structures, so we'll discuss this in more depth later. 

# Data structures

So far, we’ve been dealing with rather simple data: one value stored in an object. But R has more complex data structures that make working with large datasets easier. The ones we’re going to be talking about today are Vectors and Data Frames.

Let’s take a closer look at Vectors first.

## Vectors

R can stores multiple values of the same type in a data type called a `vector`.

* Like other objects, `vectors` are assigned values using the assignment operator
* We use the c() or concatenate function to create vectors
* Each value is separated by a comma


> ## Challenge Format
> The question goes here
>
> Use more carats for new lines 
>
> 
> > ## Solution Goes here
> > text like this
> > ```r
> > # r code goes here
> > ```
> {: .solution}
{: .challenge}

# Loading data tables 

> ## Challenge Format
> The question goes here
>
> Use more carats for new lines 
>
> 
> > ## Solution Goes here
> > text like this
> > ```r
> > # r code goes here
> > ```
> {: .solution}
{: .challenge}

```{r}

```

<!--- HTML comment 
Comments
-->

# Glossary
* R
* RStudio
* open source
* cross platform
* packages
* reproducibility
* script
* console
* environment
* working directory
* operators
* arithmetic operator
* assignment operator
* functions 
* arguments
* data type
* vector
* element
